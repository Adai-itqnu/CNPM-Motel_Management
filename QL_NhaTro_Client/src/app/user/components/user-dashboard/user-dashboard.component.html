<!-- Hero Section -->
<div class="hero-section">
  <div class="hero-content">
    <h1>Ch√†o m·ª´ng b·∫°n tr·ªü l·∫°i!</h1>
    <p>T√¨m ki·∫øm kh√¥ng gian s·ªëng l√Ω t∆∞·ªüng ho·∫∑c qu·∫£n l√Ω c√°c h√≥a ƒë∆°n c·ªßa b·∫°n ngay h√¥m nay</p>
    <button class="btn-hero">
      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      Xem l·ªãch s·ª≠ giao d·ªãch
    </button>
  </div>
  <div class="hero-image">
    <img src="https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=600&h=400&fit=crop" alt="Room">
  </div>
</div>

<!-- User's Current Booking (if exists) -->
<div class="section" *ngIf="userBooking">
  <div class="section-header">
    <h2>
      <span class="badge-count">üè† Ph√≤ng ƒëang gi·ªØ (1)</span>
    </h2>
  </div>
  
  <div class="booking-card">
    <img [src]="'http://localhost:5001' + userBooking.room.images[0]?.imageUrl" alt="Room">
    <div class="booking-info">
      <div class="booking-header">
        <h3>{{ userBooking.room.name }} - {{ userBooking.room.roomType }}</h3>
        <span class="badge-status available">Ch·ªù thanh to√°n</span>
      </div>
      <p class="booking-location">{{ userBooking.room.floor }}. Khu A ‚Ä¢ 35m¬≤</p>
      <p class="booking-price">H·∫øt h·∫°n trong 14:59</p>
      <div class="booking-actions">
        <button class="btn-pay">Thanh to√°n ngay</button>
        <button class="btn-cancel">H·ªßy gi·ªØ</button>
      </div>
    </div>
  </div>
</div>

<!-- Available Rooms List -->
<div class="section">
  <div class="section-header">
    <h2>Danh s√°ch ph√≤ng tr·ªëng</h2>
  </div>
  
  <!-- Filter Tabs -->
  <div class="filter-tabs">
    <button 
      *ngFor="let filter of filters" 
      [class.active]="selectedFilter === filter.value"
      (click)="filterRooms(filter.value)"
      class="filter-tab">
      {{ filter.label }}
    </button>
  </div>

  <!-- Skeleton Loading -->
  <div *ngIf="isLoading" class="rooms-skeleton">
    <div class="skeleton-card" *ngFor="let i of [1,2,3,4]">
      <div class="skeleton-image"></div>
      <div class="skeleton-content">
        <div class="skeleton-text"></div>
        <div class="skeleton-text short"></div>
      </div>
    </div>
  </div>

  <!-- Rooms Grid -->
  <div *ngIf="!isLoading" class="rooms-grid">
    <div class="room-card" *ngFor="let room of availableRooms">
      <div class="room-image">
        <img 
          [src]="room.images && room.images.length > 0 ? 'http://localhost:5001' + room.images[0].imageUrl : 'https://via.placeholder.com/400x300?text=No+Image'" 
          [alt]="room.name"
        >
        <span class="badge-tag available">C√≤n tr·ªëng</span>
      </div>
      
      <div class="room-info">
        <div class="room-header">
          <h3>{{ room.name }}</h3>
          <p class="room-price">{{ formatPrice(room.price) }}<span>/th√°ng</span></p>
        </div>
        
        <p class="room-location">T·∫ßng {{ room.floor }} ‚Ä¢ Khu A ‚Ä¢ {{ room.area }}m¬≤</p>
        
        <div class="room-amenities">
          <span class="amenity-icon" *ngIf="room.amenities?.length > 0">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
          </span>
          <span class="amenity-icon">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </span>
          <span class="amenity-icon">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
            </svg>
          </span>
        </div>
        
        <button class="btn-detail" (click)="viewRoomDetail(room)">Xem chi ti·∫øt</button>
      </div>
    </div>
  </div>
</div>

<!-- Room Detail Modal -->
<div class="modal-overlay" *ngIf="showRoomDetail" (click)="closeRoomDetail()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <button class="btn-close" (click)="closeRoomDetail()">
      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg>
    </button>
    
    <div class="modal-body" *ngIf="selectedRoom">
      <div class="modal-image">
        <img 
          [src]="selectedRoom.images && selectedRoom.images.length > 0 ? 'http://localhost:5001' + selectedRoom.images[0].imageUrl : 'https://via.placeholder.com/600x400?text=No+Image'" 
          [alt]="selectedRoom.name"
        >
      </div>
      
      <div class="modal-info">
        <span class="badge-success">Thanh to√°n th√†nh c√¥ng</span>
        
        <h2>{{ selectedRoom.name }} - {{ selectedRoom.roomType }}</h2>
        <p class="modal-subtitle">Khu A ‚Ä¢ T·∫ßng {{ selectedRoom.floor }}</p>
        <p class="modal-price">{{ formatPrice(selectedRoom.price) }}<span>/th√°ng</span></p>
        
        <div class="specs-grid">
          <div class="spec-item">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
            </svg>
            <div>
              <p class="spec-label">ƒêi·ªán</p>
              <p class="spec-value">{{ selectedRoom.electricityPrice || 3.5 }} ƒë/kWh</p>
            </div>
          </div>
          
          <div class="spec-item">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
            </svg>
            <div>
              <p class="spec-label">N∆∞·ªõc</p>
              <p class="spec-value">{{ selectedRoom.waterPrice || 100 }} ƒë/ng∆∞·ªùi</p>
            </div>
          </div>
          
          <div class="spec-item">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2 1 3 3 3h10c2 0 3-1 3-3V7c0-2-1-3-3-3H7C5 4 4 5 4 7z"></path>
            </svg>
            <div>
              <p class="spec-label">Di·ªán t√≠ch</p>
              <p class="spec-value">{{ selectedRoom.area }}m¬≤</p>
            </div>
          </div>
          
          <div class="spec-item">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
            </svg>
            <div>
              <p class="spec-label">S·ªë ng∆∞·ªùi</p>
              <p class="spec-value">T·ªëi ƒëa 2 ng∆∞·ªùi</p>
            </div>
          </div>
        </div>
        
        <div class="amenities-section">
          <h3>Ti·ªán √≠ch c√≥ s·∫µn</h3>
          <div class="amenities-list">
            <span class="amenity-badge" *ngFor="let amenity of selectedRoom.amenities">
              {{ amenity }}
            </span>
          </div>
        </div>
        
        <div class="description-section">
          <h3>M√¥ t·∫£ chi ti·∫øt</h3>
          <p>{{ selectedRoom.description || 'Ph√≤ng m·ªõi x√¢y, thi·∫øt k·∫ø hi·ªán ƒë·∫°i. Th√¥ng m√°t. C√≥ ban c√¥ng nh·ªè nh·∫π nh√†ng phi c·∫£m b·ªô, ƒê·∫ßy ƒë·ªß n·ªôi th·∫•t c∆° b·∫£n. Gi∆∞·ªùng, t·ªß, b√†n l√†m vi·ªác. An ninh t·ªët, c√≥ camera 24/7.' }}</p>
        </div>
        
        <div class="modal-actions">
          <button class="btn-book" (click)="openBookingModal()">ƒê·∫∑t c·ªçc ngay</button>
          <button class="btn-contact">Li√™n h·ªá</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Booking Modal -->
<div class="modal-overlay" *ngIf="showBookingModal" (click)="closeBookingModal()">
  <div class="modal-content booking-modal" (click)="$event.stopPropagation()">
    <button class="btn-close" (click)="closeBookingModal()">
      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg>
    </button>
    
    <div class="booking-modal-body" *ngIf="selectedRoom">
      <h2>ƒê·∫∑t c·ªçc ph√≤ng {{ selectedRoom.name }}</h2>
      <p class="booking-subtitle">ƒêi·ªÅn th√¥ng tin li√™n h·ªá ƒë·ªÉ ch·ªß tr·ªç c√≥ th·ªÉ li√™n h·ªá v·ªõi b·∫°n</p>
      
      <form class="booking-form">
        <div class="form-group">
          <label>S·ªë ƒëi·ªán tho·∫°i <span class="required">*</span></label>
          <input 
            type="tel" 
            [(ngModel)]="bookingForm.contactPhone" 
            name="contactPhone"
            placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i"
            required
          >
        </div>
        
        <div class="form-group">
          <label>Email <span class="required">*</span></label>
          <input 
            type="email" 
            [(ngModel)]="bookingForm.contactEmail" 
            name="contactEmail"
            placeholder="Nh·∫≠p email"
            required
          >
        </div>
        
        <div class="form-group">
          <label>Ng√†y nh·∫≠n ph√≤ng <span class="required">*</span></label>
          <input 
            type="date" 
            [(ngModel)]="bookingForm.checkInDate" 
            name="checkInDate"
            [min]="getTomorrowDate()"
            required
          >
        </div>
        
        <div class="form-group">
          <label>Ghi ch√∫</label>
          <textarea 
            [(ngModel)]="bookingForm.notes" 
            name="notes"
            rows="3"
            placeholder="Th·ªùi gian thu√™ mong mu·ªën, y√™u c·∫ßu kh√°c..."
          ></textarea>
        </div>
        
        <div class="payment-info">
          <div class="payment-method">
            <img src="https://cdn.haitrieu.com/wp-content/uploads/2022/10/Logo-VNPAY-QR.png" alt="VNPAY" height="30">
            <span>Thanh to√°n qua VNPAY</span>
          </div>
          <div class="deposit-amount">
            <span>S·ªë ti·ªÅn ƒë·∫∑t c·ªçc:</span>
            <strong>{{ formatPrice(selectedRoom.depositAmount || selectedRoom.price) }}</strong>
          </div>
        </div>
        
        <div class="modal-actions">
          <button type="button" class="btn-book" (click)="submitBooking()">X√°c nh·∫≠n & Thanh to√°n</button>
          <button type="button" class="btn-contact" (click)="closeBookingModal()">H·ªßy</button>
        </div>
      </form>
    </div>
  </div>
</div>