<div class="my-bills-container">
  <div class="page-header">
    <h1>ğŸ“„ HÃ³a ÄÆ¡n Cá»§a TÃ´i</h1>
    <p class="subtitle">Quáº£n lÃ½ vÃ  thanh toÃ¡n hÃ³a Ä‘Æ¡n hÃ ng thÃ¡ng</p>
  </div>

  <!-- Stats Cards -->
  <div class="stats-row" *ngIf="!isLoading && bills.length > 0">
    <div class="stat-card">
      <span class="stat-icon">ğŸ“‹</span>
      <div class="stat-content">
        <span class="stat-value">{{ bills.length }}</span>
        <span class="stat-label">Tá»•ng hÃ³a Ä‘Æ¡n</span>
      </div>
    </div>
    <div class="stat-card pending">
      <span class="stat-icon">â³</span>
      <div class="stat-content">
        <span class="stat-value">{{ pendingCount }}</span>
        <span class="stat-label">ChÆ°a thanh toÃ¡n</span>
      </div>
    </div>
    <div class="stat-card paid">
      <span class="stat-icon">âœ…</span>
      <div class="stat-content">
        <span class="stat-value">{{ paidCount }}</span>
        <span class="stat-label">ÄÃ£ thanh toÃ¡n</span>
      </div>
    </div>
    <div class="stat-card total">
      <span class="stat-icon">ğŸ’°</span>
      <div class="stat-content">
        <span class="stat-value">{{ formatShortCurrency(totalPending) }}</span>
        <span class="stat-label">Cáº§n thanh toÃ¡n</span>
      </div>
    </div>
  </div>

  <!-- Filter Tabs -->
  <div class="filter-tabs" *ngIf="!isLoading && bills.length > 0">
    <button [class.active]="filterStatus === 'all'" (click)="setFilter('all')">ğŸ“‹ Táº¥t cáº£</button>
    <button [class.active]="filterStatus === 'Pending'" (click)="setFilter('Pending')">â³ ChÆ°a thanh toÃ¡n</button>
    <button [class.active]="filterStatus === 'Paid'" (click)="setFilter('Paid')">âœ… ÄÃ£ thanh toÃ¡n</button>
  </div>

  <!-- Loading -->
  <div class="loading-state" *ngIf="isLoading">
    <div class="spinner"></div>
    <p>Äang táº£i...</p>
  </div>

  <!-- Error -->
  <div class="error-state" *ngIf="error && !isLoading">
    <p>{{ error }}</p>
    <button class="btn btn-primary" (click)="loadBills()">Thá»­ láº¡i</button>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!isLoading && !error && bills.length === 0">
    <div class="empty-icon">ğŸ“‹</div>
    <h3>ChÆ°a cÃ³ hÃ³a Ä‘Æ¡n nÃ o</h3>
    <p>HÃ³a Ä‘Æ¡n sáº½ xuáº¥t hiá»‡n khi báº¡n cÃ³ phÃ²ng Ä‘ang thuÃª</p>
  </div>

  <!-- Bills List -->
  <div class="bills-list" *ngIf="!isLoading && filteredBills.length > 0">
    <div class="bill-card" *ngFor="let bill of filteredBills" [class.unpaid]="bill.status === 'Pending'">
      <div class="bill-header">
        <div class="bill-period">
          <span class="month">{{ getMonthYear(bill.month, bill.year) }}</span>
          <span class="room-name">ğŸ  {{ bill.roomName }}</span>
        </div>
        <span class="status-badge" [ngClass]="getStatusClass(bill.status)">
          {{ getStatusLabel(bill.status) }}
        </span>
      </div>

      <div class="bill-body">
        <!-- Left: Details -->
        <div class="bill-details">
          <div class="detail-section">
            <h4>âš¡ Äiá»‡n</h4>
            <div class="meter-info">
              <span>{{ bill.electricityOldIndex }} â†’ {{ bill.electricityNewIndex }}</span>
              <span class="usage">({{ bill.electricityNewIndex - bill.electricityOldIndex }} kWh)</span>
            </div>
            <span class="amount">{{ formatCurrency(bill.electricityTotal) }}</span>
          </div>
          
          <div class="detail-section">
            <h4>ğŸ’§ NÆ°á»›c</h4>
            <div class="meter-info">
              <span>{{ bill.waterOldIndex }} â†’ {{ bill.waterNewIndex }}</span>
              <span class="usage">({{ bill.waterNewIndex - bill.waterOldIndex }} mÂ³)</span>
            </div>
            <span class="amount">{{ formatCurrency(bill.waterTotal) }}</span>
          </div>
          
          <div class="detail-section">
            <h4>ğŸ  Tiá»n phÃ²ng</h4>
            <span class="amount">{{ formatCurrency(bill.roomPrice) }}</span>
            <small *ngIf="bill.daysRented < bill.daysInMonth" class="pro-rata">
              ({{ bill.daysRented }}/{{ bill.daysInMonth }} ngÃ y)
            </small>
          </div>
          
          <div class="detail-section" *ngIf="bill.otherFees > 0">
            <h4>ğŸ“ PhÃ­ khÃ¡c</h4>
            <span class="amount">{{ formatCurrency(bill.otherFees) }}</span>
          </div>
        </div>

        <!-- Right: Total & Action -->
        <div class="bill-summary">
          <div class="total-section">
            <span class="total-label">Tá»•ng cá»™ng</span>
            <span class="total-amount">{{ formatCurrency(bill.totalAmount) }}</span>
          </div>
          
          <div class="due-date">
            <span *ngIf="bill.status === 'Pending'">â° Háº¡n: {{ formatDate(bill.dueDate) }}</span>
            <span *ngIf="bill.status === 'Paid'">âœ… ÄÃ£ TT: {{ formatDate(bill.paymentDate) }}</span>
          </div>

          <button 
            class="btn-pay" 
            *ngIf="bill.status === 'Pending'"
            (click)="payBill(bill)"
            [disabled]="isPayingBillId === bill.id">
            <span *ngIf="isPayingBillId !== bill.id">ğŸ’³ Thanh toÃ¡n VNPay</span>
            <span *ngIf="isPayingBillId === bill.id">Äang xá»­ lÃ½...</span>
          </button>
        </div>
      </div>

      <div class="bill-notes" *ngIf="bill.notes">
        <span class="notes-label">ğŸ“ Ghi chÃº:</span>
        <span class="notes-text">{{ bill.notes }}</span>
      </div>
    </div>
  </div>
</div>